<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
		<meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
		<title>title</title>
		<link rel="stylesheet" type="text/css" href="../css/api.css" />
		<link rel="stylesheet" type="text/css" href="../css/common.css" />
		<link rel="stylesheet" type="text/css" href="../css/admin.css" />
		<link rel="stylesheet" type="text/css" href="../css/amazeui.css" />
		<link rel="stylesheet" type="text/css" href="../css/amazeui.datatables.min.css" />
		<style>
			body {
			}
		</style>
	</head>
	<body>
		<div style="line-height: 3rem;">
			开始日期:
			<input id="beginTime" type="date" style="border: 1px solid;line-height: 2rem;height: 2rem;" />
		</div>
		<div style="line-height: 3rem;">
			结束日期:
			<input id="endTime" type="date" style="border: 1px solid;line-height: 2rem;height: 2rem;" />
			<button onclick="searchData()" style="height: 30px;width: 80px;background-color: orange;border-radius: 5px;">
				搜索
			</button>
		</div>
		<div style="height: 5px;background-color: rgb(237, 236, 236);"></div>
		<div id="kitTotal"></div>
		<script type="text/template" charset="utf-8" id='kitTotal_template'>
			{{~it:value:index}}
			<ul style="padding: 0.6rem;">
			<li>
			商家名称:{{=value.kitName}}
			</li>
			<li>
			商家卖出份数:{{=value.ordersNum}}份
			</li>
			<li>
			收货订单总金额:￥{{=value.orderTotal}}
			</li>
			</ul>
			<div style="  border-bottom: 0.1rem dashed rgb(244, 127, 12);width: 95%;margin-left: 2.5%;"></div>
			{{~}}
		</script>
	</body>
	<script type="text/javascript" src="../script/api.js"></script>
	<script type="text/javascript" src="../script/av.min.js"></script>
	<script type="text/javascript" src="../script/common.js"></script>
	<script type="text/javascript" src="../script/date.format.js"></script>
	<script type="text/javascript" src="../script/jquery-1.11.1.min.js"></script>
	<script type="text/javascript" src="../script/AV_common.js"></script>
	<!--<script type="text/javascript" src="../script/countByArea.js"></script>-->
	<script type="text/javascript" src="../script/underscore-min.js"></script>
	<script type="text/javascript">
		apiready = function() {
		};
		function searchData() {
			var start = $("#beginTime").val();
			var end = $("#endTime").val();
			var queryOrder = new AV.Query(Order);
			if (CompareDate(start, end)) {
				api.toast({
					msg : '开始日期必须小于结束日期',
					location : 'middle'
				});
			} else {
				var request = {
					startDate : start,
					endDate : end
				};
				console.log("request>>>" + JSON.stringify(request))
				AV.Cloud.run("getKitchenOrders", request).then(function(orders) {
					if (orders.length > 0) {
						var kitTotal_template = document.getElementById("kitTotal").innerHTML;
						document.getElementById("kitTotal").innerHTML = doT.template(kitTotal_template)(orders);
					}
				}).catch(function(err) {
					errorAlert(JSON.stringify(err))
					api.toast({
						msg : '查询订单出错！',
						location : 'middle'
					});
				})
			}
		}

		function CompareDate(d1, d2) {
			return ((new Date(d1.replace(/-/g, "\/"))) > (new Date(d2.replace(/-/g, "\/"))));
		}
	</script>
</html>