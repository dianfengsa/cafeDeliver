<!DOCTYPE HTML>
<html>
	<head>
		<meta name="content-type" content="text/html" charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,minimal-ui">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black" />
		<meta name="format-detection" content="telephone=no">
		<link href="../css/web_css.css" rel="stylesheet">
		<!--页面样式-->
		<link href="../css/reset.css" rel="stylesheet">
		<!--重置样式-->
		<link rel="stylesheet" href="../css/flex-layout.css">
		<link rel="stylesheet" href="../css/layout.css">
		<link rel="stylesheet" href="../css/index.css">
		<title>配送请求</title>
	</head>
	<body>
		<div class="top">
			<header class="m-header flex-column flex-middle flex-item-24">
				<p class="header-text flex-item-24 flex-center">
					<i class="back"></i>配送订单<i class="refresh"></i>
				</p>
			</header>
			<nav class="nav-box flex-item-24 flex-around flex-column">
				<div class="flex-item-8 nav-text active" id="nav-1">
					<span>待接单</span><i id="nav-new1" class="nav-new"></i>
				</div>
				<div class="flex-item-8 nav-text" id="nav-2">
					<span>配送中</span><i id="nav-new2" class="nav-new"></i>
				</div>
				<div class="flex-item-8 nav-text " id="nav-3">
					<span>已完成</span>
				</div>
			</nav>
		</div>
		<!--顶部导航栏!-->
		<div class="mask flex-item-24"></div>
		<!--弹窗事件的遮罩-->
		<div class="m-content flex-item-24 flex-row flex-center " id="m-content">
			<!--订单模版渲染区域-->
			<div class="m-container-1 flex-item-24 flex-column flex-center" id="waitingOrder">
				<div class="user-box flex-item-23 ">
					<div class="user-info-top flex-item-24 ">
						<div class="user-info-text">
							<p>
								客户电话：15915251578
							</p>
							<p class="fr orderNumber" >
								编号：6552}
							</p>
						</div>
					</div>
					<div class="user-info-body flex-row flex-item-24 flex-center">
						<div class="user-info-add  flex-row flex-item-24 flex-center">
							<ul class="user-info-add-text flex-item-23 flex-center">
								<li>
									<div class="clock"></div><span class="clock-text">30分钟预达</span><span class="money"><i>&#165</i> 50.00</span>
								</li>
								<li class="clearfix">
									<div class="destination">
										送
									</div><span class="add-destination">荷花田旗舰餐厅-珠海市吉大景园路景山路1号</span>
								</li>
								<li class="clearfix">
									<div class="source">
										取
									</div><span class="add-source">珠海市香洲区吉大钰海环球金融中心5楼312室腾飞科技有限公司融中心5楼312室腾飞科技有限公司融中心5楼312室腾飞科技有限公司</span>
								</li>
							</ul>
						</div>
					</div>
				</div>
				<div class="flex-item-24 flex-center notform flex-bottom">
					暂无更多订单···
				</div>
			</div>
			<div class="m-container-2 flex-item-24 flex-column flex-center" id="deliverOrder">
				<div class="user-box flex-item-23 ">
					<div class="user-info-top flex-item-24 ">
						<div class="user-info-text">
							<p>
								客户电话：15915251578
							</p>
							<p class="fr orderNumber" >
								编号：2554
							</p>
						</div>
					</div>
					<div class="user-info-body flex-row flex-item-24 flex-center">
						<div class="user-info-add  flex-row flex-item-24 flex-center">
							<ul class="user-info-add-text flex-item-23 flex-center">
								<li>
									<div class="clock"></div><span class="clock-text">30分钟预达</span><span class="money"><i>&#165</i> 55.00</span>
								</li>
								<li class="clearfix">
									<div class="destination">
										送
									</div><span class="add-destination">荷花田旗舰餐厅-珠海市吉大景园路景山路1号</span>
								</li>
								<li class="clearfix">
									<div class="source">
										取
									</div><span class="add-source">珠海市香洲区吉大钰海环球金融中心5楼312室腾飞科技有限公司</span>
								</li>
							</ul>
						</div>
					</div>
				</div>
				<div class="flex-item-24 flex-center notform flex-bottom">
					暂无更多订单···
				</div>
			</div>
			<div class="m-container-3 flex-item-24 flex-column flex-center" id="finishedOrder">
				<div class="user-box flex-item-23 ">
					<div class="user-info-top flex-item-24 ">
						<div class="user-info-text">
							<p>
								客户电话：15915251578
							</p>
							<p class="fr orderNumber" >
								编号：2354
							</p>
						</div>
					</div>
					<div class="user-info-body flex-row flex-item-24 flex-center">
						<div class="user-info-add  flex-row flex-item-24 flex-center">
							<ul class="user-info-add-text flex-item-23 flex-center">
								<li class="clearfix order-complete">
									<div class="complete-img"></div><span class="">订单已完成</span>
								</li>
								<li class="clearfix">
									<div class="destination">
										送
									</div><span class="add-destination">荷花田旗舰餐厅-珠海市吉大景园路景山路1号</span>
								</li>
								<li class="clearfix">
									<div class="source">
										取
									</div><span class="add-source">珠海市香洲区吉大钰海环球金融中心5楼312室腾飞科技有限公司</span>
								</li>
							</ul>
						</div>
					</div>
				</div>
				<div class="user-box flex-item-23 ">
					<div class="user-info-top flex-item-24 ">
						<div class="user-info-text">
							<p>
								客户电话：15915251578
							</p>
							<p class="fr orderNumber" >
								编号：2354
							</p>
						</div>
					</div>
					<div class="user-info-body flex-row flex-item-24 flex-center">
						<div class="user-info-add  flex-row flex-item-24 flex-center">
							<ul class="user-info-add-text flex-item-23 flex-center">
								<li class="clearfix order-refund">
									<div class="cancel-img"></div><span class="">订单已退单</span>
								</li>
								<li class="clearfix">
									<div class="destination">
										送
									</div><span class="add-destination">荷花田旗舰餐厅-珠海市吉大景园路景山路1号</span>
								</li>
								<li class="clearfix">
									<div class="source">
										取
									</div><span class="add-source">珠海市香洲区吉大钰海环球金融中心5楼312室腾飞科技有限公司</span>
								</li>
							</ul>
						</div>
					</div>
				</div>
				<div class="user-box flex-item-23 ">
					<div class="user-info-top flex-item-24 ">
						<div class="user-info-text">
							<p>
								客户电话：15915251578
							</p>
							<p class="fr orderNumber" >
								编号：2354
							</p>
						</div>
					</div>
					<div class="user-info-body flex-row flex-item-24 flex-center">
						<div class="user-info-add  flex-row flex-item-24 flex-center">
							<ul class="user-info-add-text flex-item-23 flex-center">
								<li class="clearfix order-cancel">
									<div class="cancel-img"></div><span class="">订单已取消</span>
								</li>
								<li class="clearfix">
									<div class="destination">
										送
									</div><span class="add-destination">荷花田旗舰餐厅-珠海市吉大景园路景山路1号</span>
								</li>
								<li class="clearfix">
									<div class="source">
										取
									</div><span class="add-source">珠海市香洲区吉大钰海环球金融中心5楼312室腾飞科技有限公司</span>
								</li>
							</ul>
						</div>
					</div>
				</div>
				<div class="flex-item-24 flex-center notform flex-bottom">
					暂无更多订单···
				</div>
			</div>
		</div>
		<footer class="footer-box flex-item-24 flex-middle flex-column flex-between">
			<div class="flex-item-4 footer-text  active" id="footer-1">
				<span><img src="../image/calendar_active.png" />
					<p>
						外卖订单
					</p></span><i id="footer-new1"></i>
			</div>
			<div class="flex-item-4 footer-text" id="footer-2">
				<span><img src="../image/process.png" />
					<p>
						配送请求
					</p></span>
			</div>
			<div class="flex-item-4 footer-text" id="footer-3">
				<span><img src="../image/Viewlist.png" />
					<p>
						公交配送
					</p></span>
			</div>
			<div class="flex-item-4 footer-text" id="footer-4">
				<span><img src="../image/account.png" />
					<p>
						我的信息
					</p></span>
			</div>
			<div class="flex-item-4 footer-text" id="footer-5">
				<span><img src="../image/process.png" />
					<p>
						堂食餐点
					</p></span>
			</div>
		</footer>
		<!--底部固定栏-->
	</body>
	<script src="../newAppJs/jquery.min.js"></script>
	<script src="../newAppJs/jquery.touchSwipe.min.js"></script>
	<script src="../newAppJs/jquery.rotate.min.js"></script>
	<script src="../newAppJs/iscroll.js"></script>
	<script src="../newAppJs/api.js"></script>
	<script src="../newAppJs/doT.min.js"></script>
	<!--模版配置脚本-->
	<script src="../newAppJs/orderDelive.js"></script>
	<script src="../newAppJs/underscore-min.js"></script>
	<script src="../newAppJs/wilddog.js" ></script>
	<!--页面脚本-->
	<script src="../newAppJs/share.js"></script>
	<script>
		var pageParam;
		apiready = function() {
			pageParam = api.pageParam;
			console.log("pageParam>>>>" + JSON.stringify(pageParam))
			if (pageParam) {
				var ref = new Wilddog("https://kaifanba.wilddogio.com/deliveryOrderRef/" + pageParam.cafeCar);
				var proArray = new Array();
				var waitingArr = [], deliverArr = [], finishedArr = [];
				ref.limitToFirst(100).on("value", function(datasnapshot) {
					//状态为等待接单
					waitingArr = _.filter(datasnapshot.val(), function(val, key) {
						return val.status == "等待接单";
					});
					//					var templateWartting = document.getElementById('template_warttingOrder').innerHTML;
					//					document.getElementById('warttingOrder').innerHTML = doT.template( templateWartting )(waitingArr);
					//状态为配送中
					deliverArr = _.filter(datasnapshot.val(), function(val, key) {
						return val.status == "配送中";
					});
					//状态为已收货
					finishedArr = _.filter(datasnapshot.val(), function(val, key) {
						return val.status == "已收货" || val.status == "已拒单" || val.status == "已退款";
					});
				});
				console.log("配送请求》》waitingArr>>>" + JSON.stringify(waitingArr))
				console.log("配送请求》》deliverArr>>>>" + JSON.stringify(deliverArr))
				console.log("配送请求》》finishedArr>>>>" + JSON.stringify(finishedArr))
			}
			//外卖订单
			$(".footer-box").on("touchend", "#footer-1", function() {
				openOrderDelive(pageParam);
			});
			//配送请求
			$(".footer-box").on("touchend", "#footer-2", function() {
				openOrderRequest(pageParam);
			});
			//订单搜索
			$(".footer-box").on("touchend", "#footer-3", function() {
				openOrderSearch(pageParam);
			});
			//配送员信息
			$(".footer-box").on("touchend", "#footer-4", function() {
				openOrderDeliveInfo(pageParam);
			});
		}
	</script>
</html>