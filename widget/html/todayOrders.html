<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
		<title>今日订单</title>
		<link rel="stylesheet" type="text/css" href="../css/api.css" />
		<link rel="stylesheet" type="text/css" href="../css/common.css" />
		<link rel="stylesheet" type="text/css" href="../css/todayOrders.css" />
	</head>
	<body>
		<div class="header" id="header">
			<div class="backIcon" onclick="goBack();"><img src="../image/deliver/icon_back.png" alt="" />
			</div>
			<div class="title">
				<span>今日订单</span>
			</div>
		</div>
		<div class="navbar" id="navbar">
			<div class="typebar">
				<div class="delivering" id="delivering" onclick="changeOrderList(0);">
					<span>配送中</span>
				</div>
				<div class="finish-active" id="finish" onclick="changeOrderList(1);">
					<span>已收货</span>
				</div>
			</div>
		</div>
		<div id="main"></div>
	</body>
	<script type="text/javascript" src="../script/api.js"></script>
	<script type="text/javascript" src="../script/av.min.js"></script>
	<script type="text/javascript" src="../script/AV_common.js"></script>
	<script type="text/javascript" src="../script/common.js"></script>
	<script>
		var navBar = $api.dom('.navbar');
		apiready = function() {
			api.addEventListener({
				name : 'keyback'
			}, function(ret, err) {
				goBack();
			});
			loadingOrderLists();
		}
		function goBack() {
			api.closeWin({
			});
		}

		function changeOrderList(index) {
			var tmp = $api.getStorage('frameIndex');
			if (tmp) {
				$api.rmStorage('frameIndex');
			}
			$api.setStorage('frameIndex', index);
			api.setFrameGroupIndex({
				name : 'todayOrders',
				index : index,
				sroll : true
			});
		}

		function setFrameGroupStatus(frameIndex) {
			switch (frameIndex) {
				case 0: {
					document.getElementById('delivering').className = 'delivering-active';
					document.getElementById('finish').className = 'finish';
					break;
				}
				case 1: {
					document.getElementById('delivering').className = 'delivering';
					document.getElementById('finish').className = 'finish-active';
					break;
				}
				default:
					break;
			}
		}

		function loadingOrderLists() {
			window.header = $api.byId('header');
			$api.fixStatusBar(header);
			var headerPos = $api.offset(header);
			var navbar = $api.byId('navbar');
			var navPos = $api.offset(navbar);
			var main = $api.byId('main');
			var mainPos = $api.offset(main);
			var height = headerPos.h + navPos.h;
			alert(123)
			api.openFrameGroup({
				name : 'todayOrders',
				background : '#EFEFEF',
				scrollEnabled : false,
				rect : {
					x : 0,
					y : height,
					w : 'auto',
					h : 'auto'
				},
				index : 1,
				preload : 1,
				frames : [{
					name : 'delivering',
					url : '../html/orderList_simple.html',
					pageParam : {
						type : 0
					},
					bounces : false,
					opaque : true,
					bgColor : '#EFEFEF',
				}, {
					name : 'finish',
					url : '../html/orderList_simple.html',
					pageParam : {
						type : 1
					},
					bounces : false,
					opaque : true,
					bgColor : '#EFEFEF'
				}]
			}, function(ret, err) {
				var name = ret.name;
				var index = ret.index;
				var tmp = $api.getStorage('frameIndex');
				if (tmp) {
					$api.rmStorage('frameIndex');
				}
				$api.setStorage('frameIndex', index);
				setFrameGroupStatus(index);
			});
		}
	</script>
</html>
